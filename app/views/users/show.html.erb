<% content_for :title do %>
  <%= "Papoters | " %><%= @user.name_anonymous %>
<% end %>

<div class="padded-top-xxl padded-bottom-xs bg-gradient text-center user-top">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-lg-10 col-lg-offset-1">
        <%= render 'users/avatar', user: @user, size: 'avatar-xlarge' %>
        <%= render 'users/info', user: @user %>
        <% if policy(@user).dashboard? %>
          <p><%= link_to t('.see_dashboard'), dashboard_path %></p>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="padded-top-xs padded-bottom-xl">
  <div class="container">
    <div class="row">

      <div class="<%= @user == current_user ? 'col-xs-8 col-lg-5 col-lg-offset-1' : 'col-xs-12 col-lg-5 col-lg-offset-1' %>" >
        <h2>
          <% if @user == current_user %>
            <%= t('.about_me') %>
          <% else %>
            <%= t('.about', user: @user.first_name) %>
          <% end %>
        </h2>
      </div>
      <% if policy(@user).edit? %>
        <div class="col-xs-4 col-lg-5 text-right user-edit-profile">
          <p>
            <%= link_to edit_user_registration_path do %>
              <i class="fa fa-pencil" aria-hidden="true"></i>&nbsp; <%= t('.edit_my_profile') %>
            <% end %>
          </p>
        </div>
      <% end %>

      <div class="col-xs-12 col-lg-10 col-lg-offset-1 padded-top-xs">
        <% if @user.bio.present? %>
          <%= sanitize markdown_to_html(@user.bio) %>
        <% elsif policy(@user).edit? %>
          <p class="font-weight-normal"><%= t('.no_information_you') %></p>
          <p><%= link_to t('.edit_your_profile'), edit_user_registration_path %> <%= t('.be_known') %></p>
        <% else %>
          <p><%= t('.no_information', user: @user.first_name) %></p>
        <% end %>
      </div>

    </div>
  </div>
</div>

<div class="bg-light-gray padded-top-s padded-bottom-xl">
  <div class="container">
    <div class="row">

      <div class="<%= @user == current_user ? 'col-xs-6 col-lg-5 col-lg-offset-1' : 'col-xs-12 col-lg-5 col-lg-offset-1' %>" >
        <h2>
          <% if @user == current_user %>
            <%= t('.my_offers') %>
          <% else %>
            <%= t('.offers', user: @user.first_name) %>
          <% end %>
        </h2>
      </div>
      <% if policy(@user.offers.new).new? %>
        <div class="col-xs-6 col-lg-5 text-right padded-top-xs">
          <%= link_to new_offer_path, class: "btn btn-form btn-green" do %>
            <i class='fa fa-plus' aria-hidden='true'></i>&nbsp;&nbsp; <%= t '.new_offer' %>
          <% end %>
        </div>
      <% end %>

      <div class="col-xs-12 col-lg-10 col-lg-offset-1">
        <% if @user == current_user %>
          <% if @user.offers_published.present? %>
            <% @user.offers_published.each do |offer| %>
              <%= render "offers/card_without_user", offer: offer %>
            <% end %>
          <% else %>
            <div class="padded-top-xs">
              <p class="font-weight-normal"><%= t '.no_offers_you' %></p>
              <p><%= link_to t('.publish_offer'), new_offer_path %> <%= t '.or' %> <%= link_to t('.find_out_more'), be_advisor_path %> <%= t '.know_more' %></p>
            </div>
          <% end %>
        <% else %>
          <% if @user.offers_active.present? %>
            <% @user.offers_active.each do |offer| %>
              <%= render "offers/card_without_user", offer: offer %>
            <% end %>
          <% else %>
            <p><%= t '.no_offers', user: @user.first_name %></p>
          <% end %>
        <% end %>
      </div>

    </div>
  </div>
</div>

<div class="padded-top-xs padded-bottom-xl">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-lg-10 col-lg-offset-1">

        <h3>
          <%= t('.reviews', count: @deals_reviewed.total_count) %>
        </h3>
        <h6>
          <span class="yellow font-weight-normal">
            <%= @user.advisor_deals_reviewed.count %>
            <%= t '.advice_given' %>
          </span>
          &nbsp; | &nbsp;
          <span class="green font-weight-normal">
            <%= @user.client_deals_reviewed.count %>
            <%= t '.advice_received' %>
          </span>
        </h6>

        <div>
          <% if  @deals_reviewed.present? %>
            <div id="user_reviews_page">
              <%= render 'reviews' %>
            </div>
            <div class="text-center padded-top-xs" id="user-reviews-paginator" >
              <%= paginate @deals_reviewed, remote: true  %>
            </div>
          <% elsif @user == current_user %>
            <hr class="bd-gray">
            <p><%= t '.no_reviews_you' %></p>
          <% else %>
            <hr class="bd-gray">
            <p><p><%= t '.no_reviews', user: @user.first_name %></p>
          <% end %>
        </div>

      </div>
    </div>
  </div>
</div>
